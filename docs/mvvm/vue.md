## Vue

### é¢è¯•

1. React / Vue.js ä¹‹ç±»çš„æ¡†æž¶ä¸ºä»€ä¹ˆéœ€è¦ç»™ç»„ä»¶æ·»åŠ  key å±žæ€§ï¼Œå…¶ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ



### åŒå‘æ•°æ®ç»‘å®š

å€Ÿç”¨ç½‘ä¸Šä¸€å¼ å›¾æ¥è¯´ä¸€ä¸‹åŒå‘æ•°æ®ç»‘å®š

![](../_media/åŒå‘æ•°æ®ç»‘å®š.png)

å¯ä»¥å‘çŽ°`Object.definePropertyå’ŒProxy`éƒ½å¤„äºŽæ•°æ®åŠ«æŒ

æ•°æ®åŠ«æŒçš„ä¼˜åŠ¿:

1. æ— éœ€æ˜¾ç¤ºè°ƒç”¨
2. å¯ç²¾ç¡®å¾—çŸ¥å˜åŒ–æ•°æ®

### mixin

æ··å…¥ (mixin) æä¾›äº†ä¸€ç§éžå¸¸çµæ´»çš„æ–¹å¼ï¼Œæ¥åˆ†å‘ Vue ç»„ä»¶ä¸­çš„å¯å¤ç”¨åŠŸèƒ½ã€‚ä¸€ä¸ªæ··å…¥å¯¹è±¡å¯ä»¥åŒ…å«ä»»æ„ç»„ä»¶é€‰é¡¹ã€‚å½“ç»„ä»¶ä½¿ç”¨æ··å…¥å¯¹è±¡æ—¶ï¼Œæ‰€æœ‰æ··å…¥å¯¹è±¡çš„é€‰é¡¹å°†è¢«â€œæ··åˆâ€è¿›å…¥è¯¥ç»„ä»¶æœ¬èº«çš„é€‰é¡¹ã€‚

å¯é‡ç”¨æ€§é«˜ã€‚ 

é‚£å¦‚æžœæ˜¯`import`ä¸€ä¸ªå¯¹è±¡è¿›æ¥å’Œ`mixin`æœ‰å•¥åŒºåˆ«å‘¢? 

`import`è¿›æ¥çš„

**å…¨å±€æ··å…¥**:  å¯¹æ¯ä¸ªç»„ä»¶éƒ½ç”Ÿæ•ˆ

```
Vue.mixin({
  create(){}
})
```

**ç»„ä»¶æ··å…¥** : åªå¯¹å½“å‰ç»„ä»¶ç”Ÿæ•ˆ

```vue
import mixins from 'util/mixin.js'
export default {
  mixins: [mixins]
}
```

æ³¨æ„:

å½“ç»„ä»¶å’Œæ··å…¥å¯¹è±¡å«æœ‰åŒåé€‰é¡¹æ—¶ï¼Œ

1. æ•°æ®å¯¹è±¡åœ¨å†…éƒ¨ä¼šè¿›è¡Œé€’å½’åˆå¹¶ï¼Œå¹¶åœ¨å‘ç”Ÿå†²çªæ—¶ä»¥ç»„ä»¶æ•°æ®ä¼˜å…ˆ
2. åŒåé’©å­å‡½æ•°å°†åˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå› æ­¤éƒ½å°†è¢«è°ƒç”¨ã€‚å¦å¤–ï¼Œæ··å…¥å¯¹è±¡çš„é’©å­å°†åœ¨ç»„ä»¶è‡ªèº«é’©å­**ä¹‹å‰**è°ƒç”¨
3. å€¼ä¸ºå¯¹è±¡çš„é€‰é¡¹ï¼Œä¾‹å¦‚ `methods`ã€`components` å’Œ `directives`ï¼Œå°†è¢«åˆå¹¶ä¸ºåŒä¸€ä¸ªå¯¹è±¡ã€‚ä¸¤ä¸ªå¯¹è±¡é”®åå†²çªæ—¶ï¼Œå–ç»„ä»¶å¯¹è±¡çš„é”®å€¼å¯¹

### è‡ªå®šä¹‰æŒ‡ä»¤(directive)

éœ€è¦å¯¹æ™®é€š DOM å…ƒç´ è¿›è¡Œåº•å±‚æ“ä½œï¼Œè¿™æ—¶å€™å°±ä¼šç”¨åˆ°è‡ªå®šä¹‰æŒ‡ä»¤

ä¸€ä¸ªæŒ‡ä»¤å®šä¹‰å¯¹è±¡å¯ä»¥æä¾›å¦‚ä¸‹å‡ ä¸ªé’©å­å‡½æ•° (å‡ä¸ºå¯é€‰)ï¼š

`bind` åªè°ƒç”¨ä¸€æ¬¡ï¼ŒæŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ æ—¶è°ƒç”¨

`inserted` è¢«ç»‘å®šå…ƒç´ æ’å…¥çˆ¶èŠ‚ç‚¹æ—¶è°ƒç”¨

`update` æ‰€åœ¨ç»„ä»¶çš„ VNode æ›´æ–°æ—¶è°ƒç”¨

`componentUpdated` æŒ‡ä»¤æ‰€åœ¨ç»„ä»¶çš„ VNode åŠå…¶å­ VNode å…¨éƒ¨æ›´æ–°åŽè°ƒç”¨

`unbind` åªè°ƒç”¨ä¸€æ¬¡ï¼ŒæŒ‡ä»¤ä¸Žå…ƒç´ è§£ç»‘æ—¶è°ƒç”¨

é¡ºåºä¼ é€’ä»¥ä¸‹å‚æ•°

`el` æŒ‡ä»¤æ‰€ç»‘å®šçš„å…ƒç´ ï¼Œå¯ä»¥ç”¨æ¥ç›´æŽ¥æ“ä½œDOM

`binding` {name(æŒ‡ä»¤å,ä¸åŒ…å«v-), value(æŒ‡ä»¤çš„ç»‘å®šå€¼), oldValue(æŒ‡ä»¤ç»‘å®šçš„å‰ä¸€ä¸ªå€¼), arg(ä¼ å‚ v-show:yes eg: yes)ï¼Œ modifiers(ä¿®é¥°ç¬¦ v-show.hide eg: hide)}

`vnode`  Vueç¼–è¯‘ç”Ÿæˆçš„è™šæ‹ŸèŠ‚ç‚¹

`oldVnode` ä¸Šä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹

**å…¨å±€æŒ‡ä»¤**

```vue
Vue.directive('track', {
  bind(el, binding){
    console.log('å¼€å§‹ç›‘å¬')
  }
})
```

**ç»„ä»¶æŒ‡ä»¤**

```vue
import track from './directives'
new Vue({
  directives: {
    track
  }
})
```


### è¿‡æ»¤å™¨filter

ç”¨äºŽä¸€äº›å¸¸è§çš„æ–‡æœ¬æ ¼å¼åŒ–ã€‚ è¿‡æ»¤å™¨å¯ä»¥ç”¨åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼šåŒèŠ±æ‹¬å·æ’å€¼å’Œ`v-bind`è¡¨è¾¾å¼. 

```
{message | filterA}
```

**å…¨å±€è¿‡æ»¤å™¨** 

```
Vue.filter('format', function(value) {
  return dayjs(value).format('YYYY-MM-DD')
})
```

**å±€éƒ¨è¿‡æ»¤å™¨**

```
filters: {
  format(value){
    return dayjs(value).format('YYYY-MM-DD')
  }
}

```

### ç»„ä»¶

æŠ½ç¦»å‡ºéƒ¨åˆ†å…¬å…±ç»„ä»¶

**å…¨å±€æ³¨å†Œ**

```
Vue.component('Button', {
  data,
  template,
  props,

})
```

### ç”Ÿå‘½å‘¨æœŸ

![](https://cn.vuejs.org/images/lifecycle.png)

åˆ›å»º

beforeCreate

created

æŒ‚è½½

beforeMount

mounted

æ›´æ–°

beforeUpdate

updated

keep-aliveçš„çŠ¶æ€

activated

deactivated

å¸è½½

beforeDestroy

destroyed

### computed

è®¡ç®—å±žæ€§. è®¡ç®—å±žæ€§çš„ç»“æžœä¼šè¢«ç¼“å­˜. åªæœ‰è®¡ç®—å±žæ€§ä¾èµ–çš„dataä¿®æ”¹æ—¶æ‰ä¼šæ›´æ–°ç¼“å­˜.

### é«˜é˜¶ç»„ä»¶

`transition`å’Œ`keep-alive`

`keep-alive` æ¶‰åŠåˆ°çš„`LRU`ç®—æ³•

max è®¾ç½®æœ€å¤šå¯ä»¥ç¼“å­˜å¤šå°‘ç»„ä»¶ 

åœ¨ keep-alive ä¸­ç¼“å­˜è¾¾åˆ° maxï¼Œæ–°å¢žç¼“å­˜å®žä¾‹ä¼šä¼˜å…ˆæ·˜æ±°æœ€è¿‘æ²¡æœ‰è¢«è®¿é—®åˆ°çš„å®žä¾‹ðŸŽ‰ðŸŽ‰ðŸŽ‰

1. LRUç¼“å­˜

è®¾ç½®æœ€å¤§ç¼“å­˜max, è¶…è¿‡çš„æ—¶å€™åˆ é™¤ä½¿ç”¨æœ€å°‘çš„

``` javascript
class LRU {
  constructor(max) {
    this.cache = new Map()
    this.max = max
  }

  get(key) {
    if(this.cache.has(key)) {
      let temp = this.cache.get(key)
      this.cache.delete(key)
      this.cache.set(key, temp)
      return temp
    }
    return -1
  }

  set(key, value) {
    // æ›´æ–°
    if(this.cache.has(key)) {
      this.cache.delete(key)
    } else {
      // æ–°å¢ž å¤„ç†æ˜¯å¦å¤§äºŽmax
      if(this.cache.size >= this.max) {
        this.cache.delete(this.cache.keys().next().value)
      }
    }
    this.cache.set(key, value)
  }
}

```